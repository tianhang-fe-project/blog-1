(window.webpackJsonp=window.webpackJsonp||[]).push([[158],{396:function(s,a,t){"use strict";t.r(a);var n=t(2),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"bios和主引导记录mbr"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bios和主引导记录mbr"}},[s._v("#")]),s._v(" BIOS和主引导记录MBR")]),s._v(" "),t("p",[s._v("计算机有2种模式："),t("strong",[s._v("实模式")]),s._v("与"),t("strong",[s._v("保护模式")]),s._v("：")]),s._v(" "),t("ul",[t("li",[s._v("实模式：刚开机🔋。存取有1MB的空间，CPU单任务运行，寻址方式是段地址+偏移地址")]),s._v(" "),t("li",[s._v("保护模式：操作系统接管后。寻址方式是段（32位）+偏移量（32位），段页式寻址方式，CPU多任务。")])]),s._v(" "),t("h3",{attrs:{id:"实模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实模式"}},[s._v("#")]),s._v(" 实模式")]),s._v(" "),t("p",[s._v("分为："),t("strong",[s._v("基本内存")]),s._v("、"),t("strong",[s._v("显卡内存")]),s._v("、"),t("strong",[s._v("BIOS")]),s._v("。其中BIOS分为：显示卡BIOS、IDE控制器BIOS、系统BIOS。")]),s._v(" "),t("h3",{attrs:{id:"系统bios"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统bios"}},[s._v("#")]),s._v(" 系统BIOS")]),s._v(" "),t("p",[s._v("下面介绍"),t("strong",[s._v("系统BIOS")]),s._v("，它的功能有：")]),s._v(" "),t("ul",[t("li",[s._v("系统启动配置")]),s._v(" "),t("li",[s._v("基本的设备IO服务，采用中断方式实现")]),s._v(" "),t("li",[s._v("加电自检（POST），初始化基本硬件（CPU、内存），不正常的时候，错误通过喇叭提示")])]),s._v(" "),t("p",[s._v("对于"),t("strong",[s._v("加电自检")]),s._v("的工作流程：按下PowerON/Reset，执行FFFF0处的指令，执行："),t("code",[s._v("JUMP POST;")])]),s._v(" "),t("h3",{attrs:{id:"mbr-硬盘分区-格式化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mbr-硬盘分区-格式化"}},[s._v("#")]),s._v(" MBR/硬盘分区/格式化")]),s._v(" "),t("p",[s._v("每个分区的首扇区都非常重要（图中蓝色和绿色），关系如下图所示：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6ly1g7ggvbkt4hj30my0fadmk.jpg",alt:"image-20190929162737042"}})]),s._v(" "),t("h3",{attrs:{id:"bios和mbr的程序运行过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#bios和mbr的程序运行过程"}},[s._v("#")]),s._v(" BIOS和MBR的程序运行过程")]),s._v(" "),t("p",[s._v("简单来说：POST -> CMOS -> MBR -> PBR。如下图所示。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6ly1g7ggxdu3m0j31fk0nsqj9.jpg",alt:"image-20190929162938087"}})]),s._v(" "),t("h2",{attrs:{id:"操作系统启动过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#操作系统启动过程"}},[s._v("#")]),s._v(" 操作系统启动过程")]),s._v(" "),t("p",[s._v("定义：从加点开始到用户工作环境准备好的过程。分为初始引导、核心初始化、系统初始化。")]),s._v(" "),t("h3",{attrs:{id:"_1-初始引导"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-初始引导"}},[s._v("#")]),s._v(" 1. 初始引导")]),s._v(" "),t("p",[s._v("目的：把"),t("strong",[s._v("os核心")]),s._v("装入内存并使之开始接管计算机系统。")]),s._v(" "),t("p",[s._v("过程：")]),s._v(" "),t("pre",[t("code",[s._v("1. 加电，JUMP POST\n2. BIOS中**启动程序**运行：\n  \t1. 读取MBR\n  \t2. 加载MBR中的**引导程序**\n3. 引导程序：\n\t1. 根据参数，读取硬盘指定位置的文件装入内存\n\t2. 加载硬盘上的**OS内核**，初始化基本参数\n")])]),s._v(" "),t("h3",{attrs:{id:"_2-核心初始化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-核心初始化"}},[s._v("#")]),s._v(" 2. 核心初始化")]),s._v(" "),t("p",[s._v("目的：OS内核初始化系统的核心数据。")]),s._v(" "),t("p",[s._v("例如：寄存器初始化、页表初始化、核心进程构建。")]),s._v(" "),t("h3",{attrs:{id:"_3-系统初始化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-系统初始化"}},[s._v("#")]),s._v(" 3. 系统初始化")]),s._v(" "),t("p",[s._v("目的：为用户使用系统作准备，是系统处于"),t("strong",[s._v("待命状态")]),s._v("。")]),s._v(" "),t("p",[s._v("例如：初始化文件系统、控制台、网络系统")]),s._v(" "),t("h2",{attrs:{id:"用户界面的概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户界面的概念"}},[s._v("#")]),s._v(" 用户界面的概念")]),s._v(" "),t("p",[s._v("定义：os提供给用户控制计算机的机制，又称"),t("strong",[s._v("用户接口")]),s._v("。")]),s._v(" "),t("p",[s._v("分类：操作界面、系统调用。")]),s._v(" "),t("p",[s._v("操作界面：图形用户接口（窗口、图标、鼠标）、键盘命令（普通命令、批处理程序、shell）")]),s._v(" "),t("p",[s._v("目前最常用的shell是BASH。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6ly1g7goojpn6zj30ke0e4jy7.jpg",alt:"image-20190929205755683"}})]),s._v(" "),t("h2",{attrs:{id:"shell脚本编程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shell脚本编程"}},[s._v("#")]),s._v(" SHELL脚本编程")]),s._v(" "),t("p",[s._v("shell脚本由shell环境"),t("strong",[s._v("解释执行")]),s._v("（不需编译）")]),s._v(" "),t("p",[s._v("执行脚本文件，需要具有可执行属性："),t("code",[s._v("chmod +x run.sh")])]),s._v(" "),t("p",[s._v("执行脚本的时候，刚开始可以用 "),t("code",[s._v("!#")]),s._v("+"),t("code",[s._v("shell绝对路径")]),s._v("的方法来指定默认使用的shell。通过："),t("code",[s._v("cat /etc/shells")]),s._v(" 可以查看系统支持的所有shell，以及分别的绝对路径。")]),s._v(" "),t("p",[s._v("下面是输入读取的例子：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -n 读入字符个数；-p 提示文字；输入内容赋值给answer变量")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Enter your choice: "')]),s._v(" answer\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# case-esac 结构")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$answer")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n  Y"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("y"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  N"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" no\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  *"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please input Y or N"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("esac")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("下面是if-else的例子：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Please input x,y: "')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" x y\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x='),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$x")]),s._v(", y="),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$y")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v(" x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" y "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x is larger than y"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elif")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("((")]),s._v(" x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" y"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("))")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("  \n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x is equal to y"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" \n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x is less than y"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h2",{attrs:{id:"系统调用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统调用"}},[s._v("#")]),s._v(" 系统调用")]),s._v(" "),t("p",[t("strong",[s._v("定义")]),s._v("：操作系统"),t("strong",[s._v("内核")]),s._v("，为应用程序提供的"),t("strong",[s._v("服务/函数")]),s._v("。例如"),t("code",[s._v("printf()")]),s._v("、"),t("code",[s._v("exit()")]),s._v("。这些函数是在"),t("strong",[s._v("内核空间")]),s._v("实现的。")]),s._v(" "),t("p",[t("strong",[s._v("特点")]),s._v("：")]),s._v(" "),t("pre",[t("code",[s._v("- 一般涉及**核心资源**或**硬件**的操作；\n- 运行于**核态**；\n- 每个系统调用都有**对应的唯一的编号**；\n- 会产生**自愿中断**\n")])]),s._v(" "),t("p",[s._v("过程如下图所示。简单来说：调用->保护现场->编号查找入口地址->调用功能->恢复现场->结束中断。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://tva1.sinaimg.cn/large/006y8mN6ly1g7hg2p3xg2j30pq0h6wme.jpg",alt:"image-20190930124542133"}})]),s._v(" "),t("p",[s._v("下面是一个c的实例代码：")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[s._v("#"),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello World!\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("这段代码涉及到外设显卡(printf)、进程(exit)操作。在mac下，编译后的汇编代码部分如下：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('## %bb.0:\n\tpushq\t%rbp\n\t.cfi_def_cfa_offset 16\n\t.cfi_offset %rbp, -16\n\tmovq\t%rsp, %rbp\n\t.cfi_def_cfa_register %rbp\n\tsubq\t$16, %rsp\n\tmovl\t$0, -4(%rbp)\n\tleaq\tL_.str(%rip), %rdi\n\txorl\t%eax, %eax\n\tmovb\t%al, %cl\n\tmovl\t%eax, -8(%rbp)          ## 4-byte Spill\n\tmovb\t%cl, %al\n\tcallq\t_printf\n\tmovl\t-8(%rbp), %edi          ## 4-byte Reload\n\tmovl\t%eax, -12(%rbp)         ## 4-byte Spill\n\tcallq\t_exit\n\t.cfi_endproc\n                                        ## -- End function\n\t.section\t__TEXT,__cstring,cstring_literals\nL_.str:                                 ## @.str\n\t.asciz\t"Hello World!\\n"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("其中，"),t("code",[s._v("movl\t%eax, -8(%rbp)")]),s._v("和"),t("code",[s._v("movl\t%eax, -12(%rbp)")]),s._v("就是向eax寄存器中，指定系统调用号。通过"),t("code",[s._v("callq")]),s._v("进入系统调用，并且执行。")])])}),[],!1,null,null,null);a.default=e.exports}}]);